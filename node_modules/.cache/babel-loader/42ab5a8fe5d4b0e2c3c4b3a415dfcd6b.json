{"ast":null,"code":"import _slicedToArray from \"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _inherits from \"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport _classCallCheck from \"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nexport var InputBox = /*#__PURE__*/function () {\n  function InputBox(idl, ui) {\n    var _this = this;\n\n    _classCallCheck(this, InputBox);\n\n    this.idl = idl;\n    this.ui = ui;\n    this.label = null;\n    this.value = undefined;\n    var status = document.createElement('span');\n    status.className = 'status';\n    this.status = status;\n\n    if (ui.input) {\n      ui.input.addEventListener('blur', function () {\n        if (ui.input.value === '') {\n          return;\n        }\n\n        _this.parse();\n      });\n      ui.input.addEventListener('input', function () {\n        status.style.display = 'none';\n        ui.input.classList.remove('reject');\n      });\n    }\n  }\n\n  _createClass(InputBox, [{\n    key: \"isRejected\",\n    value: function isRejected() {\n      return this.value === undefined;\n    }\n  }, {\n    key: \"parse\",\n    value: function parse() {\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      if (this.ui.form) {\n        var value = this.ui.form.parse(config);\n        this.value = value;\n        return value;\n      }\n\n      if (this.ui.input) {\n        var input = this.ui.input;\n\n        try {\n          var _value = this.ui.parse(this.idl, config, input.value);\n\n          if (!this.idl.covariant(_value)) {\n            throw new Error(\"\".concat(input.value, \" is not of type \").concat(this.idl.display()));\n          }\n\n          this.status.style.display = 'none';\n          this.value = _value;\n          return _value;\n        } catch (err) {\n          input.classList.add('reject');\n          this.status.style.display = 'block';\n          this.status.innerHTML = 'InputError: ' + err.message;\n          this.value = undefined;\n          return undefined;\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"render\",\n    value: function render(dom) {\n      var container = document.createElement('span');\n\n      if (this.label) {\n        var label = document.createElement('label');\n        label.innerText = this.label;\n        container.appendChild(label);\n      }\n\n      if (this.ui.input) {\n        container.appendChild(this.ui.input);\n        container.appendChild(this.status);\n      }\n\n      if (this.ui.form) {\n        this.ui.form.render(container);\n      }\n\n      dom.appendChild(container);\n    }\n  }]);\n\n  return InputBox;\n}();\nexport var InputForm = /*#__PURE__*/function () {\n  function InputForm(ui) {\n    _classCallCheck(this, InputForm);\n\n    this.ui = ui;\n    this.form = [];\n  }\n\n  _createClass(InputForm, [{\n    key: \"renderForm\",\n    value: function renderForm(dom) {\n      var _this2 = this;\n\n      if (this.ui.container) {\n        this.form.forEach(function (e) {\n          return e.render(_this2.ui.container);\n        });\n        dom.appendChild(this.ui.container);\n      } else {\n        this.form.forEach(function (e) {\n          return e.render(dom);\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render(dom) {\n      if (this.ui.open && this.ui.event) {\n        dom.appendChild(this.ui.open);\n        var form = this; // eslint-disable-next-line\n\n        form.ui.open.addEventListener(form.ui.event, function () {\n          // Remove old form\n          if (form.ui.container) {\n            form.ui.container.innerHTML = '';\n          } else {\n            var oldContainer = form.ui.open.nextElementSibling;\n\n            if (oldContainer) {\n              oldContainer.parentNode.removeChild(oldContainer);\n            }\n          } // Render form\n\n\n          form.generateForm();\n          form.renderForm(dom);\n        });\n      } else {\n        this.generateForm();\n        this.renderForm(dom);\n      }\n    }\n  }]);\n\n  return InputForm;\n}();\nexport var RecordForm = /*#__PURE__*/function (_InputForm) {\n  _inherits(RecordForm, _InputForm);\n\n  var _super = _createSuper(RecordForm);\n\n  function RecordForm(fields, ui) {\n    var _this3;\n\n    _classCallCheck(this, RecordForm);\n\n    _this3 = _super.call(this, ui);\n    _this3.fields = fields;\n    _this3.ui = ui;\n    return _this3;\n  }\n\n  _createClass(RecordForm, [{\n    key: \"generateForm\",\n    value: function generateForm() {\n      var _this4 = this;\n\n      this.form = this.fields.map(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            key = _ref2[0],\n            type = _ref2[1];\n\n        var input = _this4.ui.render(type); // eslint-disable-next-line\n\n\n        if (_this4.ui.labelMap && _this4.ui.labelMap.hasOwnProperty(key)) {\n          input.label = _this4.ui.labelMap[key] + ' ';\n        } else {\n          input.label = key + ' ';\n        }\n\n        return input;\n      });\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(config) {\n      var _this5 = this;\n\n      var v = {};\n      this.fields.forEach(function (_ref3, i) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            key = _ref4[0],\n            _ = _ref4[1];\n\n        var value = _this5.form[i].parse(config);\n\n        v[key] = value;\n      });\n\n      if (this.form.some(function (input) {\n        return input.isRejected();\n      })) {\n        return undefined;\n      }\n\n      return v;\n    }\n  }]);\n\n  return RecordForm;\n}(InputForm);\nexport var TupleForm = /*#__PURE__*/function (_InputForm2) {\n  _inherits(TupleForm, _InputForm2);\n\n  var _super2 = _createSuper(TupleForm);\n\n  function TupleForm(components, ui) {\n    var _this6;\n\n    _classCallCheck(this, TupleForm);\n\n    _this6 = _super2.call(this, ui);\n    _this6.components = components;\n    _this6.ui = ui;\n    return _this6;\n  }\n\n  _createClass(TupleForm, [{\n    key: \"generateForm\",\n    value: function generateForm() {\n      var _this7 = this;\n\n      this.form = this.components.map(function (type) {\n        var input = _this7.ui.render(type);\n\n        return input;\n      });\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(config) {\n      var _this8 = this;\n\n      var v = [];\n      this.components.forEach(function (_, i) {\n        var value = _this8.form[i].parse(config);\n\n        v.push(value);\n      });\n\n      if (this.form.some(function (input) {\n        return input.isRejected();\n      })) {\n        return undefined;\n      }\n\n      return v;\n    }\n  }]);\n\n  return TupleForm;\n}(InputForm);\nexport var VariantForm = /*#__PURE__*/function (_InputForm3) {\n  _inherits(VariantForm, _InputForm3);\n\n  var _super3 = _createSuper(VariantForm);\n\n  function VariantForm(fields, ui) {\n    var _this9;\n\n    _classCallCheck(this, VariantForm);\n\n    _this9 = _super3.call(this, ui);\n    _this9.fields = fields;\n    _this9.ui = ui;\n    return _this9;\n  }\n\n  _createClass(VariantForm, [{\n    key: \"generateForm\",\n    value: function generateForm() {\n      var index = this.ui.open.selectedIndex;\n\n      var _this$fields$index = _slicedToArray(this.fields[index], 2),\n          _ = _this$fields$index[0],\n          type = _this$fields$index[1];\n\n      var variant = this.ui.render(type);\n      this.form = [variant];\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(config) {\n      var select = this.ui.open;\n      var selected = select.options[select.selectedIndex].value;\n      var value = this.form[0].parse(config);\n\n      if (value === undefined) {\n        return undefined;\n      }\n\n      var v = {};\n      v[selected] = value;\n      return v;\n    }\n  }]);\n\n  return VariantForm;\n}(InputForm);\nexport var OptionForm = /*#__PURE__*/function (_InputForm4) {\n  _inherits(OptionForm, _InputForm4);\n\n  var _super4 = _createSuper(OptionForm);\n\n  function OptionForm(ty, ui) {\n    var _this10;\n\n    _classCallCheck(this, OptionForm);\n\n    _this10 = _super4.call(this, ui);\n    _this10.ty = ty;\n    _this10.ui = ui;\n    return _this10;\n  }\n\n  _createClass(OptionForm, [{\n    key: \"generateForm\",\n    value: function generateForm() {\n      if (this.ui.open.checked) {\n        var opt = this.ui.render(this.ty);\n        this.form = [opt];\n      } else {\n        this.form = [];\n      }\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(config) {\n      if (this.form.length === 0) {\n        return [];\n      } else {\n        var value = this.form[0].parse(config);\n\n        if (value === undefined) {\n          return undefined;\n        }\n\n        return [value];\n      }\n    }\n  }]);\n\n  return OptionForm;\n}(InputForm);\nexport var VecForm = /*#__PURE__*/function (_InputForm5) {\n  _inherits(VecForm, _InputForm5);\n\n  var _super5 = _createSuper(VecForm);\n\n  function VecForm(ty, ui) {\n    var _this11;\n\n    _classCallCheck(this, VecForm);\n\n    _this11 = _super5.call(this, ui);\n    _this11.ty = ty;\n    _this11.ui = ui;\n    return _this11;\n  }\n\n  _createClass(VecForm, [{\n    key: \"generateForm\",\n    value: function generateForm() {\n      var len = +this.ui.open.value;\n      this.form = [];\n\n      for (var i = 0; i < len; i++) {\n        var t = this.ui.render(this.ty);\n        this.form.push(t);\n      }\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(config) {\n      var value = this.form.map(function (input) {\n        return input.parse(config);\n      });\n\n      if (this.form.some(function (input) {\n        return input.isRejected();\n      })) {\n        return undefined;\n      }\n\n      return value;\n    }\n  }]);\n\n  return VecForm;\n}(InputForm);","map":{"version":3,"sources":["../../src/candid-core.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["export class InputBox {\n    constructor(idl, ui) {\n        this.idl = idl;\n        this.ui = ui;\n        this.label = null;\n        this.value = undefined;\n        const status = document.createElement('span');\n        status.className = 'status';\n        this.status = status;\n        if (ui.input) {\n            ui.input.addEventListener('blur', () => {\n                if (ui.input.value === '') {\n                    return;\n                }\n                this.parse();\n            });\n            ui.input.addEventListener('input', () => {\n                status.style.display = 'none';\n                ui.input.classList.remove('reject');\n            });\n        }\n    }\n    isRejected() {\n        return this.value === undefined;\n    }\n    parse(config = {}) {\n        if (this.ui.form) {\n            const value = this.ui.form.parse(config);\n            this.value = value;\n            return value;\n        }\n        if (this.ui.input) {\n            const input = this.ui.input;\n            try {\n                const value = this.ui.parse(this.idl, config, input.value);\n                if (!this.idl.covariant(value)) {\n                    throw new Error(`${input.value} is not of type ${this.idl.display()}`);\n                }\n                this.status.style.display = 'none';\n                this.value = value;\n                return value;\n            }\n            catch (err) {\n                input.classList.add('reject');\n                this.status.style.display = 'block';\n                this.status.innerHTML = 'InputError: ' + err.message;\n                this.value = undefined;\n                return undefined;\n            }\n        }\n        return null;\n    }\n    render(dom) {\n        const container = document.createElement('span');\n        if (this.label) {\n            const label = document.createElement('label');\n            label.innerText = this.label;\n            container.appendChild(label);\n        }\n        if (this.ui.input) {\n            container.appendChild(this.ui.input);\n            container.appendChild(this.status);\n        }\n        if (this.ui.form) {\n            this.ui.form.render(container);\n        }\n        dom.appendChild(container);\n    }\n}\nexport class InputForm {\n    constructor(ui) {\n        this.ui = ui;\n        this.form = [];\n    }\n    renderForm(dom) {\n        if (this.ui.container) {\n            this.form.forEach(e => e.render(this.ui.container));\n            dom.appendChild(this.ui.container);\n        }\n        else {\n            this.form.forEach(e => e.render(dom));\n        }\n    }\n    render(dom) {\n        if (this.ui.open && this.ui.event) {\n            dom.appendChild(this.ui.open);\n            const form = this;\n            // eslint-disable-next-line\n            form.ui.open.addEventListener(form.ui.event, () => {\n                // Remove old form\n                if (form.ui.container) {\n                    form.ui.container.innerHTML = '';\n                }\n                else {\n                    const oldContainer = form.ui.open.nextElementSibling;\n                    if (oldContainer) {\n                        oldContainer.parentNode.removeChild(oldContainer);\n                    }\n                }\n                // Render form\n                form.generateForm();\n                form.renderForm(dom);\n            });\n        }\n        else {\n            this.generateForm();\n            this.renderForm(dom);\n        }\n    }\n}\nexport class RecordForm extends InputForm {\n    constructor(fields, ui) {\n        super(ui);\n        this.fields = fields;\n        this.ui = ui;\n    }\n    generateForm() {\n        this.form = this.fields.map(([key, type]) => {\n            const input = this.ui.render(type);\n            // eslint-disable-next-line\n            if (this.ui.labelMap && this.ui.labelMap.hasOwnProperty(key)) {\n                input.label = this.ui.labelMap[key] + ' ';\n            }\n            else {\n                input.label = key + ' ';\n            }\n            return input;\n        });\n    }\n    parse(config) {\n        const v = {};\n        this.fields.forEach(([key, _], i) => {\n            const value = this.form[i].parse(config);\n            v[key] = value;\n        });\n        if (this.form.some(input => input.isRejected())) {\n            return undefined;\n        }\n        return v;\n    }\n}\nexport class TupleForm extends InputForm {\n    constructor(components, ui) {\n        super(ui);\n        this.components = components;\n        this.ui = ui;\n    }\n    generateForm() {\n        this.form = this.components.map(type => {\n            const input = this.ui.render(type);\n            return input;\n        });\n    }\n    parse(config) {\n        const v = [];\n        this.components.forEach((_, i) => {\n            const value = this.form[i].parse(config);\n            v.push(value);\n        });\n        if (this.form.some(input => input.isRejected())) {\n            return undefined;\n        }\n        return v;\n    }\n}\nexport class VariantForm extends InputForm {\n    constructor(fields, ui) {\n        super(ui);\n        this.fields = fields;\n        this.ui = ui;\n    }\n    generateForm() {\n        const index = this.ui.open.selectedIndex;\n        const [_, type] = this.fields[index];\n        const variant = this.ui.render(type);\n        this.form = [variant];\n    }\n    parse(config) {\n        const select = this.ui.open;\n        const selected = select.options[select.selectedIndex].value;\n        const value = this.form[0].parse(config);\n        if (value === undefined) {\n            return undefined;\n        }\n        const v = {};\n        v[selected] = value;\n        return v;\n    }\n}\nexport class OptionForm extends InputForm {\n    constructor(ty, ui) {\n        super(ui);\n        this.ty = ty;\n        this.ui = ui;\n    }\n    generateForm() {\n        if (this.ui.open.checked) {\n            const opt = this.ui.render(this.ty);\n            this.form = [opt];\n        }\n        else {\n            this.form = [];\n        }\n    }\n    parse(config) {\n        if (this.form.length === 0) {\n            return [];\n        }\n        else {\n            const value = this.form[0].parse(config);\n            if (value === undefined) {\n                return undefined;\n            }\n            return [value];\n        }\n    }\n}\nexport class VecForm extends InputForm {\n    constructor(ty, ui) {\n        super(ui);\n        this.ty = ty;\n        this.ui = ui;\n    }\n    generateForm() {\n        const len = +this.ui.open.value;\n        this.form = [];\n        for (let i = 0; i < len; i++) {\n            const t = this.ui.render(this.ty);\n            this.form.push(t);\n        }\n    }\n    parse(config) {\n        const value = this.form.map(input => {\n            return input.parse(config);\n        });\n        if (this.form.some(input => input.isRejected())) {\n            return undefined;\n        }\n        return value;\n    }\n}\n//# sourceMappingURL=candid-core.js.map"]},"metadata":{},"sourceType":"module"}