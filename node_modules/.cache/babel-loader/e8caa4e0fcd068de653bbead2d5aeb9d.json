{"ast":null,"code":"import _slicedToArray from \"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _createForOfIteratorHelper from \"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _classCallCheck from \"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport * as IDL from './idl';\nimport { Principal } from '@dfinity/principal';\nimport * as UI from './candid-core';\nvar InputConfig = {\n  parse: parsePrimitive\n};\nvar FormConfig = {\n  render: renderInput\n};\nexport var inputBox = function inputBox(t, config) {\n  return new UI.InputBox(t, Object.assign(Object.assign({}, InputConfig), config));\n};\nexport var recordForm = function recordForm(fields, config) {\n  return new UI.RecordForm(fields, Object.assign(Object.assign({}, FormConfig), config));\n};\nexport var tupleForm = function tupleForm(components, config) {\n  return new UI.TupleForm(components, Object.assign(Object.assign({}, FormConfig), config));\n};\nexport var variantForm = function variantForm(fields, config) {\n  return new UI.VariantForm(fields, Object.assign(Object.assign({}, FormConfig), config));\n};\nexport var optForm = function optForm(ty, config) {\n  return new UI.OptionForm(ty, Object.assign(Object.assign({}, FormConfig), config));\n};\nexport var vecForm = function vecForm(ty, config) {\n  return new UI.VecForm(ty, Object.assign(Object.assign({}, FormConfig), config));\n};\nexport var Render = /*#__PURE__*/function (_IDL$Visitor) {\n  _inherits(Render, _IDL$Visitor);\n\n  var _super = _createSuper(Render);\n\n  function Render() {\n    _classCallCheck(this, Render);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Render, [{\n    key: \"visitType\",\n    value: function visitType(t, d) {\n      var input = document.createElement('input');\n      input.classList.add('argument');\n      input.placeholder = t.display();\n      return inputBox(t, {\n        input: input\n      });\n    }\n  }, {\n    key: \"visitNull\",\n    value: function visitNull(t, d) {\n      return inputBox(t, {});\n    }\n  }, {\n    key: \"visitRecord\",\n    value: function visitRecord(t, fields, d) {\n      var config = {};\n\n      if (fields.length > 1) {\n        var container = document.createElement('div');\n        container.classList.add('popup-form');\n        config = {\n          container: container\n        };\n      }\n\n      var form = recordForm(fields, config);\n      return inputBox(t, {\n        form: form\n      });\n    }\n  }, {\n    key: \"visitTuple\",\n    value: function visitTuple(t, components, d) {\n      var config = {};\n\n      if (components.length > 1) {\n        var container = document.createElement('div');\n        container.classList.add('popup-form');\n        config = {\n          container: container\n        };\n      }\n\n      var form = tupleForm(components, config);\n      return inputBox(t, {\n        form: form\n      });\n    }\n  }, {\n    key: \"visitVariant\",\n    value: function visitVariant(t, fields, d) {\n      var select = document.createElement('select');\n\n      var _iterator = _createForOfIteratorHelper(fields),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _step$value = _slicedToArray(_step.value, 2),\n              key = _step$value[0],\n              type = _step$value[1];\n\n          var option = new Option(key);\n          select.add(option);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      select.selectedIndex = -1;\n      select.classList.add('open');\n      var config = {\n        open: select,\n        event: 'change'\n      };\n      var form = variantForm(fields, config);\n      return inputBox(t, {\n        form: form\n      });\n    }\n  }, {\n    key: \"visitOpt\",\n    value: function visitOpt(t, ty, d) {\n      var checkbox = document.createElement('input');\n      checkbox.type = 'checkbox';\n      checkbox.classList.add('open');\n      var form = optForm(ty, {\n        open: checkbox,\n        event: 'change'\n      });\n      return inputBox(t, {\n        form: form\n      });\n    }\n  }, {\n    key: \"visitVec\",\n    value: function visitVec(t, ty, d) {\n      var len = document.createElement('input');\n      len.type = 'number';\n      len.min = '0';\n      len.max = '100';\n      len.style.width = '8rem';\n      len.placeholder = 'len';\n      len.classList.add('open');\n      var container = document.createElement('div');\n      container.classList.add('popup-form');\n      var form = vecForm(ty, {\n        open: len,\n        event: 'change',\n        container: container\n      });\n      return inputBox(t, {\n        form: form\n      });\n    }\n  }, {\n    key: \"visitRec\",\n    value: function visitRec(t, ty, d) {\n      return renderInput(ty);\n    }\n  }]);\n\n  return Render;\n}(IDL.Visitor);\n\nvar Parse = /*#__PURE__*/function (_IDL$Visitor2) {\n  _inherits(Parse, _IDL$Visitor2);\n\n  var _super2 = _createSuper(Parse);\n\n  function Parse() {\n    _classCallCheck(this, Parse);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(Parse, [{\n    key: \"visitNull\",\n    value: function visitNull(t, v) {\n      return null;\n    }\n  }, {\n    key: \"visitBool\",\n    value: function visitBool(t, v) {\n      if (v === 'true') {\n        return true;\n      }\n\n      if (v === 'false') {\n        return false;\n      }\n\n      throw new Error(\"Cannot parse \".concat(v, \" as boolean\"));\n    }\n  }, {\n    key: \"visitText\",\n    value: function visitText(t, v) {\n      return v;\n    }\n  }, {\n    key: \"visitFloat\",\n    value: function visitFloat(t, v) {\n      return parseFloat(v);\n    }\n  }, {\n    key: \"visitNumber\",\n    value: function visitNumber(t, v) {\n      return BigInt(v);\n    }\n  }, {\n    key: \"visitPrincipal\",\n    value: function visitPrincipal(t, v) {\n      return Principal.fromText(v);\n    }\n  }, {\n    key: \"visitService\",\n    value: function visitService(t, v) {\n      return Principal.fromText(v);\n    }\n  }, {\n    key: \"visitFunc\",\n    value: function visitFunc(t, v) {\n      var x = v.split('.', 2);\n      return [Principal.fromText(x[0]), x[1]];\n    }\n  }]);\n\n  return Parse;\n}(IDL.Visitor);\n\nvar Random = /*#__PURE__*/function (_IDL$Visitor3) {\n  _inherits(Random, _IDL$Visitor3);\n\n  var _super3 = _createSuper(Random);\n\n  function Random() {\n    _classCallCheck(this, Random);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(Random, [{\n    key: \"visitNull\",\n    value: function visitNull(t, v) {\n      return null;\n    }\n  }, {\n    key: \"visitBool\",\n    value: function visitBool(t, v) {\n      return Math.random() < 0.5;\n    }\n  }, {\n    key: \"visitText\",\n    value: function visitText(t, v) {\n      return Math.random().toString(36).substring(6);\n    }\n  }, {\n    key: \"visitFloat\",\n    value: function visitFloat(t, v) {\n      return Math.random();\n    }\n  }, {\n    key: \"visitInt\",\n    value: function visitInt(t, v) {\n      return BigInt(this.generateNumber(true));\n    }\n  }, {\n    key: \"visitNat\",\n    value: function visitNat(t, v) {\n      return BigInt(this.generateNumber(false));\n    }\n  }, {\n    key: \"visitFixedInt\",\n    value: function visitFixedInt(t, v) {\n      return BigInt(this.generateNumber(true));\n    }\n  }, {\n    key: \"visitFixedNat\",\n    value: function visitFixedNat(t, v) {\n      return BigInt(this.generateNumber(false));\n    }\n  }, {\n    key: \"generateNumber\",\n    value: function generateNumber(signed) {\n      var num = Math.floor(Math.random() * 100);\n\n      if (signed && Math.random() < 0.5) {\n        return -num;\n      } else {\n        return num;\n      }\n    }\n  }]);\n\n  return Random;\n}(IDL.Visitor);\n\nfunction parsePrimitive(t, config, d) {\n  if (config.random && d === '') {\n    return t.accept(new Random(), d);\n  } else {\n    return t.accept(new Parse(), d);\n  }\n}\n/**\n *\n * @param t an IDL type\n * @returns an input for that type\n */\n\n\nexport function renderInput(t) {\n  return t.accept(new Render(), null);\n}\n/**\n *\n * @param t an IDL Type\n * @param input an InputBox\n * @param value any\n * @returns rendering that value to the provided input\n */\n\nexport function renderValue(t, input, value) {\n  return t.accept(new RenderValue(), {\n    input: input,\n    value: value\n  });\n}\n\nvar RenderValue = /*#__PURE__*/function (_IDL$Visitor4) {\n  _inherits(RenderValue, _IDL$Visitor4);\n\n  var _super4 = _createSuper(RenderValue);\n\n  function RenderValue() {\n    _classCallCheck(this, RenderValue);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(RenderValue, [{\n    key: \"visitType\",\n    value: function visitType(t, d) {\n      d.input.ui.input.value = t.valueToString(d.value);\n    } // eslint-disable-next-line @typescript-eslint/no-empty-function\n\n  }, {\n    key: \"visitNull\",\n    value: function visitNull(t, d) {}\n  }, {\n    key: \"visitText\",\n    value: function visitText(t, d) {\n      d.input.ui.input.value = d.value;\n    }\n  }, {\n    key: \"visitRec\",\n    value: function visitRec(t, ty, d) {\n      renderValue(ty, d.input, d.value);\n    }\n  }, {\n    key: \"visitOpt\",\n    value: function visitOpt(t, ty, d) {\n      if (d.value.length === 0) {\n        return;\n      } else {\n        var form = d.input.ui.form;\n        var open = form.ui.open;\n        open.checked = true;\n        open.dispatchEvent(new Event(form.ui.event));\n        renderValue(ty, form.form[0], d.value[0]);\n      }\n    }\n  }, {\n    key: \"visitRecord\",\n    value: function visitRecord(t, fields, d) {\n      var form = d.input.ui.form;\n      fields.forEach(function (_ref, i) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            key = _ref2[0],\n            type = _ref2[1];\n\n        renderValue(type, form.form[i], d.value[key]);\n      });\n    }\n  }, {\n    key: \"visitTuple\",\n    value: function visitTuple(t, components, d) {\n      var form = d.input.ui.form;\n      components.forEach(function (type, i) {\n        renderValue(type, form.form[i], d.value[i]);\n      });\n    }\n  }, {\n    key: \"visitVariant\",\n    value: function visitVariant(t, fields, d) {\n      var form = d.input.ui.form;\n      var selected = Object.entries(d.value)[0];\n      fields.forEach(function (_ref3, i) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            key = _ref4[0],\n            type = _ref4[1];\n\n        if (key === selected[0]) {\n          var open = form.ui.open;\n          open.selectedIndex = i;\n          open.dispatchEvent(new Event(form.ui.event));\n          renderValue(type, form.form[0], selected[1]);\n        }\n      });\n    }\n  }, {\n    key: \"visitVec\",\n    value: function visitVec(t, ty, d) {\n      var form = d.input.ui.form;\n      var len = d.value.length;\n      var open = form.ui.open;\n      open.value = len;\n      open.dispatchEvent(new Event(form.ui.event));\n      d.value.forEach(function (v, i) {\n        renderValue(ty, form.form[i], v);\n      });\n    }\n  }]);\n\n  return RenderValue;\n}(IDL.Visitor);","map":{"version":3,"sources":["../../src/candid-ui.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import * as IDL from './idl';\nimport { Principal } from '@dfinity/principal';\nimport * as UI from './candid-core';\nconst InputConfig = { parse: parsePrimitive };\nconst FormConfig = { render: renderInput };\nexport const inputBox = (t, config) => {\n    return new UI.InputBox(t, Object.assign(Object.assign({}, InputConfig), config));\n};\nexport const recordForm = (fields, config) => {\n    return new UI.RecordForm(fields, Object.assign(Object.assign({}, FormConfig), config));\n};\nexport const tupleForm = (components, config) => {\n    return new UI.TupleForm(components, Object.assign(Object.assign({}, FormConfig), config));\n};\nexport const variantForm = (fields, config) => {\n    return new UI.VariantForm(fields, Object.assign(Object.assign({}, FormConfig), config));\n};\nexport const optForm = (ty, config) => {\n    return new UI.OptionForm(ty, Object.assign(Object.assign({}, FormConfig), config));\n};\nexport const vecForm = (ty, config) => {\n    return new UI.VecForm(ty, Object.assign(Object.assign({}, FormConfig), config));\n};\nexport class Render extends IDL.Visitor {\n    visitType(t, d) {\n        const input = document.createElement('input');\n        input.classList.add('argument');\n        input.placeholder = t.display();\n        return inputBox(t, { input });\n    }\n    visitNull(t, d) {\n        return inputBox(t, {});\n    }\n    visitRecord(t, fields, d) {\n        let config = {};\n        if (fields.length > 1) {\n            const container = document.createElement('div');\n            container.classList.add('popup-form');\n            config = { container };\n        }\n        const form = recordForm(fields, config);\n        return inputBox(t, { form });\n    }\n    visitTuple(t, components, d) {\n        let config = {};\n        if (components.length > 1) {\n            const container = document.createElement('div');\n            container.classList.add('popup-form');\n            config = { container };\n        }\n        const form = tupleForm(components, config);\n        return inputBox(t, { form });\n    }\n    visitVariant(t, fields, d) {\n        const select = document.createElement('select');\n        for (const [key, type] of fields) {\n            const option = new Option(key);\n            select.add(option);\n        }\n        select.selectedIndex = -1;\n        select.classList.add('open');\n        const config = { open: select, event: 'change' };\n        const form = variantForm(fields, config);\n        return inputBox(t, { form });\n    }\n    visitOpt(t, ty, d) {\n        const checkbox = document.createElement('input');\n        checkbox.type = 'checkbox';\n        checkbox.classList.add('open');\n        const form = optForm(ty, { open: checkbox, event: 'change' });\n        return inputBox(t, { form });\n    }\n    visitVec(t, ty, d) {\n        const len = document.createElement('input');\n        len.type = 'number';\n        len.min = '0';\n        len.max = '100';\n        len.style.width = '8rem';\n        len.placeholder = 'len';\n        len.classList.add('open');\n        const container = document.createElement('div');\n        container.classList.add('popup-form');\n        const form = vecForm(ty, { open: len, event: 'change', container });\n        return inputBox(t, { form });\n    }\n    visitRec(t, ty, d) {\n        return renderInput(ty);\n    }\n}\nclass Parse extends IDL.Visitor {\n    visitNull(t, v) {\n        return null;\n    }\n    visitBool(t, v) {\n        if (v === 'true') {\n            return true;\n        }\n        if (v === 'false') {\n            return false;\n        }\n        throw new Error(`Cannot parse ${v} as boolean`);\n    }\n    visitText(t, v) {\n        return v;\n    }\n    visitFloat(t, v) {\n        return parseFloat(v);\n    }\n    visitNumber(t, v) {\n        return BigInt(v);\n    }\n    visitPrincipal(t, v) {\n        return Principal.fromText(v);\n    }\n    visitService(t, v) {\n        return Principal.fromText(v);\n    }\n    visitFunc(t, v) {\n        const x = v.split('.', 2);\n        return [Principal.fromText(x[0]), x[1]];\n    }\n}\nclass Random extends IDL.Visitor {\n    visitNull(t, v) {\n        return null;\n    }\n    visitBool(t, v) {\n        return Math.random() < 0.5;\n    }\n    visitText(t, v) {\n        return Math.random().toString(36).substring(6);\n    }\n    visitFloat(t, v) {\n        return Math.random();\n    }\n    visitInt(t, v) {\n        return BigInt(this.generateNumber(true));\n    }\n    visitNat(t, v) {\n        return BigInt(this.generateNumber(false));\n    }\n    visitFixedInt(t, v) {\n        return BigInt(this.generateNumber(true));\n    }\n    visitFixedNat(t, v) {\n        return BigInt(this.generateNumber(false));\n    }\n    generateNumber(signed) {\n        const num = Math.floor(Math.random() * 100);\n        if (signed && Math.random() < 0.5) {\n            return -num;\n        }\n        else {\n            return num;\n        }\n    }\n}\nfunction parsePrimitive(t, config, d) {\n    if (config.random && d === '') {\n        return t.accept(new Random(), d);\n    }\n    else {\n        return t.accept(new Parse(), d);\n    }\n}\n/**\n *\n * @param t an IDL type\n * @returns an input for that type\n */\nexport function renderInput(t) {\n    return t.accept(new Render(), null);\n}\n/**\n *\n * @param t an IDL Type\n * @param input an InputBox\n * @param value any\n * @returns rendering that value to the provided input\n */\nexport function renderValue(t, input, value) {\n    return t.accept(new RenderValue(), { input, value });\n}\nclass RenderValue extends IDL.Visitor {\n    visitType(t, d) {\n        d.input.ui.input.value = t.valueToString(d.value);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    visitNull(t, d) { }\n    visitText(t, d) {\n        d.input.ui.input.value = d.value;\n    }\n    visitRec(t, ty, d) {\n        renderValue(ty, d.input, d.value);\n    }\n    visitOpt(t, ty, d) {\n        if (d.value.length === 0) {\n            return;\n        }\n        else {\n            const form = d.input.ui.form;\n            const open = form.ui.open;\n            open.checked = true;\n            open.dispatchEvent(new Event(form.ui.event));\n            renderValue(ty, form.form[0], d.value[0]);\n        }\n    }\n    visitRecord(t, fields, d) {\n        const form = d.input.ui.form;\n        fields.forEach(([key, type], i) => {\n            renderValue(type, form.form[i], d.value[key]);\n        });\n    }\n    visitTuple(t, components, d) {\n        const form = d.input.ui.form;\n        components.forEach((type, i) => {\n            renderValue(type, form.form[i], d.value[i]);\n        });\n    }\n    visitVariant(t, fields, d) {\n        const form = d.input.ui.form;\n        const selected = Object.entries(d.value)[0];\n        fields.forEach(([key, type], i) => {\n            if (key === selected[0]) {\n                const open = form.ui.open;\n                open.selectedIndex = i;\n                open.dispatchEvent(new Event(form.ui.event));\n                renderValue(type, form.form[0], selected[1]);\n            }\n        });\n    }\n    visitVec(t, ty, d) {\n        const form = d.input.ui.form;\n        const len = d.value.length;\n        const open = form.ui.open;\n        open.value = len;\n        open.dispatchEvent(new Event(form.ui.event));\n        d.value.forEach((v, i) => {\n            renderValue(ty, form.form[i], v);\n        });\n    }\n}\n//# sourceMappingURL=candid-ui.js.map"]},"metadata":{},"sourceType":"module"}