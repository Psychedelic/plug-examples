{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _toConsumableArray from\"/Users/tomasrocchi/Documents/fleek/plug-examples/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import React,{useEffect,useState}from'react';import PlugConnect from'@psychedelic/plug-connect';import{Principal}from'@dfinity/principal';import{Actor}from'@dfinity/agent';import XtcIDL from'./idls/xtc.did';import ExtIDL from'./idls/ext.did';import'./App.css';import nnsMintingDid from'./idls/nns-minting.did';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var XTC_CANISTER_ID='aanaa-xaaaa-aaaah-aaeiq-cai';var STARVERSE_CID='nbg4r-saaaa-aaaah-qap7a-cai';var NNS_MINTING_CID='rkp4c-7iaaa-aaaaa-aaaca-cai';var CYCLES_PER_TC=1000000000000;var E8S_PER_ICP=100000000;export var to32bits=function to32bits(num){var b=new ArrayBuffer(4);new DataView(b).setUint32(0,num);return Array.from(new Uint8Array(b));};var getTokenIdentifier=function getTokenIdentifier(canister,index){var padding=Buffer.from('\\x0Atid');var array=new Uint8Array([].concat(_toConsumableArray(padding),_toConsumableArray(Principal.fromText(canister).toUint8Array()),_toConsumableArray(to32bits(index))));return Principal.fromUint8Array(array).toText();};function App(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),to=_useState2[0],setTo=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),amount=_useState4[0],setAmount=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),connected=_useState6[0],setConnected=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),nftIndex=_useState8[0],setNFTIndex=_useState8[1];var handleChangeTo=function handleChangeTo(e){return setTo(e.target.value);};var handleChangeAmount=function handleChangeAmount(e){return setAmount(e.target.value);};var handleChangeIndex=function handleChangeIndex(e){return setNFTIndex(e.target.value);};var safeXTCTransfer=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var actor,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return window.ic.plug.createActor({canisterId:XTC_CANISTER_ID,interfaceFactory:XtcIDL});case 2:actor=_context.sent;_context.next=5;return actor.transfer({to:Principal.fromText(to),amount:BigInt(amount*CYCLES_PER_TC),from:[]});case 5:response=_context.sent;console.log('response',response);case 7:case\"end\":return _context.stop();}}},_callee);}));return function safeXTCTransfer(){return _ref.apply(this,arguments);};}();var unsafeXTCTransfer=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var actor,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return Actor.createActor(XtcIDL,{agent:window.ic.plug.agent,canisterId:XTC_CANISTER_ID});case 2:actor=_context2.sent;_context2.next=5;return actor.transfer({to:Principal.fromText(to),amount:BigInt(amount*CYCLES_PER_TC),from:[]});case 5:response=_context2.sent;console.log('response',response);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function unsafeXTCTransfer(){return _ref2.apply(this,arguments);};}();var safeNFTTransfer=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var actor,response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return window.ic.plug.createActor({canisterId:STARVERSE_CID,interfaceFactory:ExtIDL});case 2:actor=_context3.sent;_context3.t0=actor;_context3.t1={principal:Principal.from(to)};_context3.next=7;return window.ic.plug.agent.getPrincipal();case 7:_context3.t2=_context3.sent;_context3.t3={principal:_context3.t2};_context3.t4=getTokenIdentifier(STARVERSE_CID,nftIndex);_context3.t5=BigInt(1);_context3.t6=new Array(32).fill(0);_context3.t7=[];_context3.t8={to:_context3.t1,from:_context3.t3,token:_context3.t4,amount:_context3.t5,memo:_context3.t6,notify:false,subaccount:_context3.t7};_context3.next=16;return _context3.t0.transfer.call(_context3.t0,_context3.t8);case 16:response=_context3.sent;console.log('response',response);case 18:case\"end\":return _context3.stop();}}},_callee3);}));return function safeNFTTransfer(){return _ref3.apply(this,arguments);};}();var unsafeNFTTransfer=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var actor,response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return Actor.createActor(ExtIDL,{agent:window.ic.plug.agent,canisterId:STARVERSE_CID});case 2:actor=_context4.sent;_context4.t0=actor;_context4.t1={principal:Principal.from(to)};_context4.next=7;return window.ic.plug.agent.getPrincipal();case 7:_context4.t2=_context4.sent;_context4.t3={principal:_context4.t2};_context4.t4=getTokenIdentifier(STARVERSE_CID,nftIndex);_context4.t5=BigInt(1);_context4.t6=new Array(32).fill(0);_context4.t7=[];_context4.t8={to:_context4.t1,from:_context4.t3,token:_context4.t4,amount:_context4.t5,memo:_context4.t6,notify:false,subaccount:_context4.t7};_context4.next=16;return _context4.t0.transfer.call(_context4.t0,_context4.t8);case 16:response=_context4.sent;console.log('response',response);case 18:case\"end\":return _context4.stop();}}},_callee4);}));return function unsafeNFTTransfer(){return _ref4.apply(this,arguments);};}();var safeCanisterCall=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var actor,response;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return window.ic.plug.createActor({canisterId:NNS_MINTING_CID,interfaceFactory:nnsMintingDid});case 2:actor=_context5.sent;_context5.t0=actor;_context5.t1=Principal.from(to);_context5.next=7;return window.ic.plug.agent.getPrincipal();case 7:_context5.t2=_context5.sent;_context5.t3={e8s:BigInt(amount*E8S_PER_ICP)};_context5.t4=BigInt(100);_context5.t5=[];_context5.t6=[];_context5.t7=BigInt(100);_context5.t8={to:_context5.t1,from:_context5.t2,amount:_context5.t3,memo:_context5.t4,notify:false,to_subaccount:_context5.t5,from_subaccount:_context5.t6,block_height:_context5.t7};_context5.next=16;return _context5.t0.transaction_notification.call(_context5.t0,_context5.t8);case 16:response=_context5.sent;console.log('response',response);case 18:case\"end\":return _context5.stop();}}},_callee5);}));return function safeCanisterCall(){return _ref5.apply(this,arguments);};}();var unsafeCanisterCall=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var actor,response;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return Actor.createActor(nnsMintingDid,{agent:window.ic.plug.agent,canisterId:NNS_MINTING_CID});case 2:actor=_context6.sent;_context6.t0=actor;_context6.t1=Principal.from(to);_context6.next=7;return window.ic.plug.agent.getPrincipal();case 7:_context6.t2=_context6.sent;_context6.t3={e8s:BigInt(amount*E8S_PER_ICP)};_context6.t4=BigInt(100);_context6.t5=[];_context6.t6=[];_context6.t7=BigInt(100);_context6.t8={to:_context6.t1,from:_context6.t2,amount:_context6.t3,memo:_context6.t4,notify:false,to_subaccount:_context6.t5,from_subaccount:_context6.t6,block_height:_context6.t7};_context6.next=16;return _context6.t0.transaction_notification.call(_context6.t0,_context6.t8);case 16:response=_context6.sent;console.log('response',response);case 18:case\"end\":return _context6.stop();}}},_callee6);}));return function unsafeCanisterCall(){return _ref6.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"flex column center\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Plug Examples\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Security Example\"}),/*#__PURE__*/_jsx(\"div\",{className:\"plug-button\",children:connected?'Connected to plug':/*#__PURE__*/_jsx(PlugConnect,{dark:true,onConnectCallback:function onConnectCallback(){return setConnected(true);},whitelist:[XTC_CANISTER_ID,STARVERSE_CID,NNS_MINTING_CID]})}),connected&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex column input-container\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"to\",children:\"Recipient principal\"}),/*#__PURE__*/_jsx(\"input\",{name:\"to\",type:\"text\",onChange:handleChangeTo,value:to})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex column input-container\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"to\",children:\"Amount of XTC\"}),/*#__PURE__*/_jsx(\"input\",{name:\"to\",type:\"number\",onChange:handleChangeAmount,value:amount})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex column input-container\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"to\",children:\"Starverse Index\"}),/*#__PURE__*/_jsx(\"input\",{name:\"to\",type:\"number\",onChange:handleChangeIndex,value:nftIndex})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"security-actions-container flex column\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Safe Calls\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!to,type:\"button\",onClick:safeXTCTransfer,children:\"Transfer \".concat(amount,\" XTC (\").concat(CYCLES_PER_TC*amount,\" cycles)\")}),/*#__PURE__*/_jsx(\"button\",{disabled:!to,type:\"button\",onClick:safeNFTTransfer,children:\"Transfer Starverse #\".concat(nftIndex)}),/*#__PURE__*/_jsx(\"button\",{disabled:!to,type:\"button\",onClick:safeCanisterCall,children:\"Call NNS Minting Canister\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"security-actions-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Unsafe Calls\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!to,type:\"button\",onClick:unsafeXTCTransfer,children:\"Transfer 0.000001 XTC (1000 cycles)\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!to,type:\"button\",onClick:unsafeNFTTransfer,children:\"Transfer NFT\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!to,type:\"button\",onClick:unsafeCanisterCall,children:\"Call NNS Minting Canister\"})]})]})]});}export default App;","map":{"version":3,"sources":["/Users/tomasrocchi/Documents/fleek/plug-examples/src/App.js"],"names":["React","useEffect","useState","PlugConnect","Principal","Actor","XtcIDL","ExtIDL","nnsMintingDid","XTC_CANISTER_ID","STARVERSE_CID","NNS_MINTING_CID","CYCLES_PER_TC","E8S_PER_ICP","to32bits","num","b","ArrayBuffer","DataView","setUint32","Array","from","Uint8Array","getTokenIdentifier","canister","index","padding","Buffer","array","fromText","toUint8Array","fromUint8Array","toText","App","to","setTo","amount","setAmount","connected","setConnected","nftIndex","setNFTIndex","handleChangeTo","e","target","value","handleChangeAmount","handleChangeIndex","safeXTCTransfer","window","ic","plug","createActor","canisterId","interfaceFactory","actor","transfer","BigInt","response","console","log","unsafeXTCTransfer","agent","safeNFTTransfer","principal","getPrincipal","fill","token","memo","notify","subaccount","unsafeNFTTransfer","safeCanisterCall","e8s","to_subaccount","from_subaccount","block_height","transaction_notification","unsafeCanisterCall"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport PlugConnect from '@psychedelic/plug-connect';\nimport { Principal } from '@dfinity/principal';\nimport { Actor } from '@dfinity/agent';\n\nimport XtcIDL from './idls/xtc.did';\nimport ExtIDL from './idls/ext.did';\nimport './App.css';\nimport nnsMintingDid from './idls/nns-minting.did';\n\nconst XTC_CANISTER_ID = 'aanaa-xaaaa-aaaah-aaeiq-cai';\nconst STARVERSE_CID = 'nbg4r-saaaa-aaaah-qap7a-cai';\nconst NNS_MINTING_CID = 'rkp4c-7iaaa-aaaaa-aaaca-cai';\nconst CYCLES_PER_TC = 1_000_000_000_000;\nconst E8S_PER_ICP = 100_000_000;\n\nexport const to32bits = (num) => {\n  const b = new ArrayBuffer(4);\n  new DataView(b).setUint32(0, num);\n  return Array.from(new Uint8Array(b));\n};\n\nconst getTokenIdentifier = (canister, index) => {\n  const padding = Buffer.from('\\x0Atid');\n  const array = new Uint8Array([\n    ...padding,\n    ...Principal.fromText(canister).toUint8Array(),\n    ...to32bits(index),\n  ]);\n  return Principal.fromUint8Array(array).toText();\n};\n\nfunction App() {\n  const [to, setTo] = useState();\n  const [amount, setAmount] = useState(0);\n  const [connected, setConnected] = useState(false);\n  const [nftIndex, setNFTIndex] = useState(0);\n  \n  const handleChangeTo = e => setTo(e.target.value);\n  const handleChangeAmount = e => setAmount(e.target.value);\n  const handleChangeIndex = e => setNFTIndex(e.target.value);\n\n  const safeXTCTransfer = async () => {\n    // create an actor to interact with XTC\n    const actor = await window.ic.plug.createActor({ canisterId: XTC_CANISTER_ID, interfaceFactory: XtcIDL });\n    // request a transfer using this actor\n    const response = await actor.transfer({ to: Principal.fromText(to), amount: BigInt(amount*CYCLES_PER_TC), from: [] });\n    console.log('response', response);\n  }\n\n  const unsafeXTCTransfer = async () => {\n    const actor = await Actor.createActor(XtcIDL, {\n      agent: window.ic.plug.agent,\n      canisterId: XTC_CANISTER_ID,\n    });\n    const response = await actor.transfer({ to: Principal.fromText(to), amount: BigInt(amount*CYCLES_PER_TC), from: [] });\n    console.log('response', response);\n  }\n\n\n  const safeNFTTransfer = async () => {\n    // create an actor to interact with XTC\n    const actor = await window.ic.plug.createActor({ canisterId: STARVERSE_CID, interfaceFactory: ExtIDL });\n    // request a transfer using this actor\n    const response = await actor.transfer({\n      to: { principal: Principal.from(to) },\n      from: { principal: await window.ic.plug.agent.getPrincipal() },\n      token: getTokenIdentifier(STARVERSE_CID, nftIndex),\n      amount: BigInt(1),\n      memo: new Array(32).fill(0),\n      notify: false,\n      subaccount: [],\n    });\n    console.log('response', response);\n  };\n\n  const unsafeNFTTransfer = async () => {\n    // create an actor to interact with XTC\n    const actor = await Actor.createActor(ExtIDL, {\n      agent: window.ic.plug.agent,\n      canisterId: STARVERSE_CID,\n    });\n    // request a transfer using this actor\n    const response = await actor.transfer({\n      to: { principal: Principal.from(to) },\n      from: { principal: await window.ic.plug.agent.getPrincipal() },\n      token: getTokenIdentifier(STARVERSE_CID, nftIndex),\n      amount: BigInt(1),\n      memo: new Array(32).fill(0),\n      notify: false,\n      subaccount: [],\n    });\n    console.log('response', response);\n  };\n\n  const safeCanisterCall = async () => {\n    const actor = await window.ic.plug.createActor({ canisterId: NNS_MINTING_CID, interfaceFactory: nnsMintingDid });\n    // request a transfer using this actor\n    const response = await actor.transaction_notification({\n      to: Principal.from(to),\n      from: await window.ic.plug.agent.getPrincipal(),\n      amount:  { e8s: BigInt(amount*E8S_PER_ICP) },\n      memo: BigInt(100),\n      notify: false,\n      to_subaccount: [],\n      from_subaccount: [],\n      block_height: BigInt(100),\n    });\n    console.log('response', response);\n  }\n\n  const unsafeCanisterCall = async () => {\n    const actor = await Actor.createActor(nnsMintingDid, {\n      agent: window.ic.plug.agent,\n      canisterId: NNS_MINTING_CID,\n    });\n    // request a transfer using this actor\n    const response = await actor.transaction_notification({\n      to: Principal.from(to),\n      from: await window.ic.plug.agent.getPrincipal(),\n      amount:  { e8s: BigInt(amount*E8S_PER_ICP) },\n      memo: BigInt(100),\n      notify: false,\n      to_subaccount: [],\n      from_subaccount: [],\n      block_height: BigInt(100),\n    });\n    console.log('response', response);\n  }\n\n  return (\n    <div className=\"flex column center\">\n      <h1>Plug Examples</h1>\n      <h2>Security Example</h2>\n      <div className=\"plug-button\">\n        {connected ? 'Connected to plug' : <PlugConnect dark onConnectCallback={() => setConnected(true)} whitelist={[XTC_CANISTER_ID, STARVERSE_CID, NNS_MINTING_CID]} />}\n      </div>\n      {connected && (\n      <>\n        <div className=\"flex column input-container\">\n          <label htmlFor=\"to\">Recipient principal</label>\n          <input name=\"to\" type=\"text\" onChange={handleChangeTo} value={to} />\n        </div>\n        <div className=\"flex column input-container\">\n          <label htmlFor=\"to\">Amount of XTC</label>\n          <input name=\"to\" type=\"number\" onChange={handleChangeAmount} value={amount} />\n        </div>\n        <div className=\"flex column input-container\">\n          <label htmlFor=\"to\">Starverse Index</label>\n          <input name=\"to\" type=\"number\" onChange={handleChangeIndex} value={nftIndex} />\n        </div>\n        <div className=\"security-actions-container flex column\">\n          <h3>Safe Calls</h3>\n          <button disabled={!to} type=\"button\" onClick={safeXTCTransfer}>{`Transfer ${amount} XTC (${CYCLES_PER_TC * amount} cycles)`}</button>\n          <button disabled={!to} type=\"button\" onClick={safeNFTTransfer}>{`Transfer Starverse #${nftIndex}`}</button>\n          <button disabled={!to} type=\"button\" onClick={safeCanisterCall}>Call NNS Minting Canister</button> \n        </div>\n        <div className=\"security-actions-container\">\n          <h3>Unsafe Calls</h3>\n          <button disabled={!to} type=\"button\" onClick={unsafeXTCTransfer}>{`Transfer 0.000001 XTC (1000 cycles)`}</button>\n          <button disabled={!to} type=\"button\" onClick={unsafeNFTTransfer}>Transfer NFT</button>\n          <button disabled={!to} type=\"button\" onClick={unsafeCanisterCall}>Call NNS Minting Canister</button> \n        </div>\n      </>\n      )}\n      \n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}